import { defineSuite } from "esbench";

const b12 = "nMrzJq4gg8PTkWQN";
const b4K = "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";

export default defineSuite({
	params: {
		dataSize: ["12 B", "4 KB"],
	},
	validate: {
		equality(a, b) {
			const v1 = new Uint8Array(a);
			const v2 = new Uint8Array(b);
			return v1.every((b, i) => b === v2[i]);
		},
	},
	setup(scene) {
		const base64 = scene.params.dataSize === "4 KB" ? b4K : b12;

		scene.bench("btoa", () => {
			const s = atob(base64);
			const view = new Uint8Array(s.length);
			for (let i = 0; i < s.length; i++) {
				view[i] = s.charCodeAt(i);
			}
			return view.buffer;
		});

		scene.benchAsync("fetch", () =>
			fetch("data:x/x;base64," + base64).then(r => r.arrayBuffer()));

		if ("fromBase64" in Uint8Array) {
			scene.benchAsync("fromBase64", () => Uint8Array.fromBase64(base64).buffer);
		} else {
			scene.warn("Uint8Array.fromBase64 is not supported in this environment");
		}
	},
});
